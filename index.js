(()=>{var w=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};var d=(e,t,r)=>(w(e,t,"read from private field"),r?r.call(e):t.get(e)),f=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},O=(e,t,r,n)=>(w(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);function l(e,t,r){let n=e["querySelector"+(r?"All":"")](t);return r?[...n||[]]:n}function p(e,t){return!!e.querySelector(t)}function g(e){let t=l.bind(l,e),r=p.bind(p,e),n=[],o=[],a="th",i=r(a);return i||(a="tr:first-child td"),n.push(...t(a,!0).map(s=>String(s.innerText).trim())),i&&t("tr",!0).filter(s=>p(s,"td")&&!s.closest("tfoot")).forEach(s=>{let h={};n.forEach((b,S)=>{let A=s.children[S];A&&(h[b]=A.innerText)}),o.push(h)}),{headers:n,data:o}}function c(e){let t=document.createElement("template");return t.innerHTML=e,t.content.firstElementChild}var{isArray:y}=Array,{entries:P}=Object,u,E,R,D,_,m=class{constructor(t){f(this,u,void 0);f(this,E,c(`
          <figure class="better-table better-table--wrapper" data-is-better-table>
            <section hidden data-hidden aria-hidden="true" class="better-table better-table--prior-table">
            </section>
            <section class="better-table better-table--target">
                <table class="better-table better-table-instance">
                    <caption><tr><td>I will have some amazing shit here at some point</td></tr></caption>
                    <thead><tr><td>I will have some amazing shit here at some point</td></tr></thead>
                    <tbody><tr><td>I will have some amazing shit here at some point</td></tr></tbody>
                    <tfoot><tr><td>I will have some amazing shit here at some point</td></tr></tfoot>
                </table>
            </section>
        </figure>`));f(this,R,[]);f(this,D,!0);f(this,_,["handleRowsChanged","handleHeadersChanged"]);O(this,u,t)}get events(){return{BEFORE_RENDER:"better-table:before-render",RENDER:"better-table:render",AFTER_RENDER:"better-table:after-render",BEFORE_RENDER_HEADERS:"better-table:before-render-headers",RENDER_HEADERS:"better-table:render-headers",AFTER_RENDER_HEADERS:"better-table:after-render-headers",BEFORE_RENDER_DATA:"better-table:before-render-data",RENDER_DATA:"better-table:render-data",AFTER_RENDER_DATA:"better-table:after-render-data",BEFORE_ROWS_CHANGED:"better-table:before-rows-changed",ROWS_CHANGED:"better-table:rows-changed",AFTER_ROWS_CHANGED:"better-table:after-rows-changed"}}set plugins(t){if(!y(t))throw new Error("Plugins array musts be an array of plugins");O(this,R,t)}get current(){return d(this,E).cloneNode(!0)}addEventListener(t,r){d(this,E).addEventListener(t,r)}dispatchEvent(t){d(this,E).dispatchEvent(t)}render(){d(this,D)&&this.initialize(),this.updateMarkup()}updateMarkup(){let{headers:t,data:r}=this.toJSON();this.dispatchEvent(new CustomEvent(this.events.BEFORE_RENDER,{detail:{table:this}})),this.dispatchEvent(new CustomEvent(this.events.BEFORE_RENDER_HEADERS,{detail:{table:this,headers:t}})),this.renderHeaders(t),this.dispatchEvent(new CustomEvent(this.events.AFTER_RENDER_HEADERS,{detail:{table:this}})),this.dispatchEvent(new CustomEvent(this.events.BEFORE_RENDER_DATA,{detail:{table:this,headers:t,data:r}})),this.renderData({headers:t,data:r}),this.dispatchEvent(new CustomEvent(this.events.AFTER_RENDER_DATA,{detail:{table:this,headers:t,data:r}})),l(d(this,E),".better-table--prior-table").append(d(this,u).cloneNode(!0)),d(this,u).replaceWith(d(this,E)),this.dispatchEvent(new CustomEvent(this.events.AFTER_RENDER,{detail:{table:this}}))}renderHeaders(t){console.log("at #renderHeaders",{headers:t});let r=l(d(this,E),".better-table-instance");l(r,"thead",!0).forEach(a=>a.remove());let n=c("<thead><tr></tr></thead>"),o=document.createDocumentFragment();for(let a of t)a&&(a instanceof HTMLTableCellElement&&o.append(a),a instanceof Function?o.append(c(a(this,t))):a.constructor===String&&o.append(c(`<th>${a}</th>`)));l(n,"tr").append(o),r.insertAdjacentElement("afterbegin",n)}renderData({headers:t,data:r}){console.log("at #renderData",{headers:t,data:r});let n=l(d(this,E),".better-table-instance");l(n,"tbody",!0).forEach(i=>i.remove());let o=c("<tbody></tbody>"),a=document.createDocumentFragment();for(let i of r){if(!i)continue;let s=c("<tr></tr>"),h=document.createDocumentFragment();if(i.constructor===Object)for(let b in i)h.append(c(`<td>${i[b]}</td>`));s.append(h),a.append(s)}o.append(a),n.insertAdjacentElement("afterbegin",o)}initialize(){d(this,R).forEach(t=>t(this));for(let t of d(this,_))this[t]=this[t].bind(this);this.addEventListener(this.events.ROWS_CHANGED,this.handleRowsChanged),this.addEventListener(this.events.HEADERS_CHANGED,this.handleHeadersChanged),O(this,D,!1)}handleRowsChanged({detail:t}){console.log(rows)}toJSON(t=d(this,u)){return g(t)}};u=new WeakMap,E=new WeakMap,R=new WeakMap,D=new WeakMap,_=new WeakMap;var H={find:l,htmlFromString:c};function N(e){console.log("at #filterable",{events:e.events}),e.addEventListener(e.events.AFTER_RENDER_DATA,({detail:t})=>{let r=[...t.data];t.data.length=0,t.data.push(...r)})}var L={UNSORTED:"&#8597;",ASC:"&#8593;",DESC:"&#8595;"},v=["UNSORTED","ASC","DESC"],x={SORT_UPDATED:"better-table-sortable:sort-updated"};function T(e){e.addEventListener(e.events.BEFORE_RENDER_HEADERS,({detail:t})=>{let{headers:r}=t,n=F.bind(F,e),o=B.bind(B,e),a=r.map((i,s)=>c(`
            <th>
                <div class="better-table-sortable better-table-sortable--header">
                    <div class="better-table-sortable better-table-sortable--header--label">${i}</div>
                    <div class="better-table-sortable better-table-sortable--header--actions">
                      <button class="better-table-sortable--header--actions better-table-sortable--header--actions--sort" data-col="${s}" data-order="${v[0]}">${L.UNSORTED}</button>
                    </div>
                </div>
            </th>
        `));a.forEach(i=>{let s=l(i,".better-table-sortable--header--actions--sort");s.addEventListener("click",n),s.addEventListener(x.SORT_UPDATED,o)}),r.length=0,r.push(...a)})}function F(e,{target:t}){let{order:r}=t.dataset,{col:n}=t.dataset;r=v[(v.indexOf(r)+1)%v.length];let o=e.toJSON(),a=o.data.sort((i,s)=>{let[h,b]=[i,s].map(A=>String(A[o.headers[Number(n)]]).trim());if(!h)return 1;if(!b)return-1;let S=h>b?1:h===b?0:-1;return r===v[2]&&(S=h<b?1:h===b?0:-1),S});e.dispatchEvent(new CustomEvent(e.events.ROWS_CHANGED,{detail:{sorted:a,col:n}})),t.dispatchEvent(new CustomEvent(x.SORT_UPDATED,{detail:{order:r}}))}function B(e,{target:t,detail:r}){let{order:n}=r;t.innerHTML=L[n],t.dataset.order=n}function C(e){}document.addEventListener("DOMContentLoaded",()=>{H.find(document,"table",!0).forEach(e=>{let t=new m(e);t.plugins=[N,T,C],t.render()})});})();
